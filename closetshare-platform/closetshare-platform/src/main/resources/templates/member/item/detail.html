<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<!-- 공통 레이아웃 -->
<head th:replace="~{/member/fragments/head :: head}"><title>Detail</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
<header th:replace="~{/member/fragments/header :: header}"></header>

<div class="container mt-5">
    <!-- Title -->
    <div class="mb-4 text-center">
        <h1 class="fw-bold text-primary" th:text="${item.title}"></h1>
    </div>

    <!-- Carousel for Images -->
    <div id="imageCarousel" class="carousel slide" data-bs-ride="carousel">
        <!-- Carousel Items -->
        <div class="carousel-inner">
            <div class="carousel-item active" th:each="image, iterStat : ${images}" th:classappend="${iterStat.index == 0} ? 'active' : ''">
                <img th:src="${image.src}" th:alt="${image.filename}" class="d-block w-100 img-clickable" style="max-height: 500px; object-fit: cover;"
                     data-bs-toggle="modal" data-bs-target="#imageModal" th:data-bs-src="${image.src}">
            </div>
        </div>

        <!-- Carousel Controls -->
        <button class="carousel-control-prev" type="button" data-bs-target="#imageCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#imageCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>

    <!-- Modal for Image -->
    <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-body p-0">
                    <img id="modalImage" src="" alt="Enlarged Image" class="img-fluid w-100" style="object-fit: contain;">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Item Details -->
    <div class="card mt-4" th:if="${users}!=null">
        <div class="card-body">
            <h2 class="text-primary">session User</h2>
            <p class="card-text fs-5" th:text="${users.getUserName()}"></p>
            <h3 th:text="${users.getAddress()}"></h3>
        </div>
    </div>

    <!-- Item Details -->
    <div class="card mt-4">
        <div class="card-body">
            <h2 class="text-primary">Item Details</h2>
            <p class="card-text fs-5" th:text="${item.title}"></p>
            <h3 th:text="${item.content}"></h3>
            <p th:text="'Category: ' + ${item.category}"></p>
        </div>
    </div>

    <!-- hasTags Details -->
    <div class="card mt-4" th:if="${!hashtags.isEmpty()}">
        <div class="card-body">
            <h2 class="text-primary">HashTags </h2>
            <p class="card-text fs-5" th:each="hashtag : ${hashtags}" th:text="${hashtag.getTagName()}"></p>
        </div>
    </div>

    <!-- Back Button -->
    <div class="d-flex justify-content-end mt-4">
        <a th:href="@{/}" class="btn btn-secondary">Back</a>
    </div>
</div>
<!-- footer section -->
<footer th:replace="~{/member/fragments/footer :: footer}"></footer>
<!-- end footer section -->

<script src="/js/jquery-3.4.1.min.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
<script src="/js/custom.js"></script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // 이미지 클릭 시 모달에 이미지 로드
    document.addEventListener("DOMContentLoaded", () => {
        const modalImage = document.getElementById("modalImage");
        const clickableImages = document.querySelectorAll(".img-clickable");

        clickableImages.forEach(image => {
            image.addEventListener("click", () => {
                modalImage.src = image.getAttribute("data-bs-src");
            });
        });
    });
</script>
</body>
</html>
